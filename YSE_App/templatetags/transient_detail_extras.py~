import datetime
from django.utils import timezone
from astropy.coordinates import EarthLocation
from astropy.coordinates import get_moon, SkyCoord
from astropy.time import Time
import astropy.units as u

def rise_set_time(self,ra,dec):

    if date:
        time = Time(self.obs_date.split()[0])
    else:
        time = Time(datetime.datetime.now())
    sc = SkyCoord(ra,dec,unit=u.deg)

    location = EarthLocation.from_geodetic(
        self.resource.telescope.longitude*u.deg,self.resource.latitude*u.deg,
        self.resource.telescope.elevation*u.m)
    tel = Observer(location=location, timezone="UTC")

    target_rise_time = tel.target_rise_time(time,sc,horizon=18*u.deg,which="previous")
	target_set_time = tel.target_set_time(time,sc,horizon=18*u.deg,which="previous")

    if target_rise_time:
        returnstarttime = target_rise_time.isot.split('T')[-1]
    else: returnstarttime = None
	if target_set_time:
        returnendtime = target_set_time.isot.split('T')[-1]
    else: returnendtime = None

	return(returnstarttime,returnendtime)
